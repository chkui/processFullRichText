<h2 id="h2_0">React</h2>
<p>
    本文记录了本人以及目前团队从无到有使用React的过程，我们将从webpack开始说起，一步一步展现React最基本的开发生态。在这里并不会介绍任何jsx或es6相关的语法，只聚焦于如何使用react生态搭建利于团队协作、有利于提升开发效率的开发环境。</p>
<h2 id="h2_1">脚手架工具——webpack&nbsp;</h2>
<p>
    工欲善必须利其器，想要高效的开发react，必须保证有一个高效有序的开发环境。我们使用的是Facebook开源的脚手架工具——webpack来搭建一个完全不依赖服务器的开发环境。实现高效集成、实时编辑可见、动态编译jsx和es6等强悍功能。</p>
<h3 id="h3_2">添加webpack</h3>
<p>
    webpack最早是Facebook的instagram团队研发出的脚手架工具，用于支持前端系统的开发。虽然webpack一直都和react嵌套在一起使用，但是他的使用场景并不局限于react，你可以把他应用于所有的前端开发场景。</p>
<p> webpack也是依赖nodejs和npm的，在安装webpack之前务必先安装nodejs的环境，nodejs和npm的安装参看:<a>
    href="https://my.oschina.net/chkui/blog/783879" rel="nofollow">https://my.oschina.net/chkui/blog/783879</a>。可以像下面这样安装一个全局的webpack环境。
</p>
<pre class="hljs elixir"><code class="hljs elixir"><span class="hljs-variable"><span
        class="hljs-variable">$ </span></span>npm install webpack -g</code></pre>
<p>或者以依赖工程的方式安装：</p>
<pre class="hljs elixir"><code class="hljs elixir"><span class="hljs-comment"><span
        class="hljs-comment"># 进入项目目录</span></span>
<span class="hljs-comment"><span class="hljs-comment"># 确定已经有 package.json，没有就通过 npm init 创建</span></span>
<span class="hljs-comment"><span class="hljs-comment"># 安装 webpack 依赖</span></span>
<span class="hljs-variable"><span class="hljs-variable">$ </span></span>npm install webpack --save-dev</code></pre>
<span id="OSC_h3_4"></span>
<h3 id="h3_3">测试运行webpack</h3>
<p> （本例子的代码存放在：<a href="https://github.com/chkui/webpack-demo" rel="nofollow">https://github.com/chkui/webpack-demo</a>。下载后用
    npm install 下载npm依赖即可使用。）</p>
<p>Setp1:简单打包</p>
<p>首先我们增加一些用于测试元素。先写一个index.html</p>
<pre class="hljs xml"><code class="language-html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span
        class="hljs-name">html</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span
        class="hljs-tag"><span class="hljs-attr">lang</span></span></span><span class="hljs-tag">=</span><span
        class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"en"</span></span></span><span
        class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span
        class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span>
    <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span
            class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span
            class="hljs-tag"><span class="hljs-attr">charset</span></span></span><span class="hljs-tag">=</span><span
            class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"UTF-8"</span></span></span><span
            class="hljs-tag">&gt;</span></span>
    <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span
            class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>Title<span
            class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span
            class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span
        class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span
        class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span>
    <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span
            class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span
            class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span
            class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bundle.js"</span></span></span><span
            class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span
            class="hljs-name"><span
            class="hljs-tag"><span class="hljs-name">script</span></span></span><span
            class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span
        class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span
        class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code></pre>
<p> 然后添加一个entry.js</p>
<pre class="hljs javascript"><code class="language-javascript hljs"><span class="hljs-comment"><span
        class="hljs-comment">/**
 * Created by chkui on 2016/11/16.
 */</span></span>
<span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span
            class="hljs-string">"!style!css!./style.css"</span></span>);
<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.write(<span class="hljs-string"><span
            class="hljs-string">'&lt;h1&gt;hello webpack&lt;/h1&gt;'</span></span>);</code></pre>
<p> 然后就可以执行打包命令了：</p>
<pre class="hljs elixir"><code class="language-bash hljs"><span class="hljs-variable">$ </span>webpack ./entry.js bundle.js</code></pre>
<p> 运行以后，就会发现在目录中生成了一个bundle.js文件。浏览器中打开index.html就会看到执行效果。</p>
<p> Step2:利用webpack分析工具打包&nbsp;</p>
<p> 增加一个名为module.js的文件：</p>
<pre class="hljs javascript"><code class="language-javascript hljs"><span class="hljs-comment"><span
        class="hljs-comment">/**
 * Created by chkui on 2016/11/16.
 */</span></span>
<span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = <span class="hljs-string"><span
            class="hljs-string">'It works from module.js.'</span></span></code></pre>
<p> 在原来的entry.js增加引用：</p>
<pre class="hljs javascript"><code class="language-javascript hljs"><span class="hljs-comment"><span
        class="hljs-comment">/**
 * Created by chkui on 2016/11/16.
 */</span></span>
<span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span
            class="hljs-string">"!style!css!./style.css"</span></span>);
<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.write(<span class="hljs-string"><span
            class="hljs-string">'&lt;h1&gt;hello webpack&lt;/h1&gt;'</span></span>);
<span class="hljs-comment"><span class="hljs-comment">//新增对module.js的引用</span></span>
<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.write(<span class="hljs-built_in"><span
            class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'./module.js'</span></span>));</code></pre>
<p> 然后同样执行webpack打包命令：</p>
<pre class="hljs elixir"><code class="language-bash hljs"><span class="hljs-variable">$ </span>webpack ./entry.js bundle.js</code></pre>
<p>
    然后在打开index.html，会发现我们新增加的module.js的内容被正确输出。这是因为我们在页面中通过nodejs的require的方式引入的module.js，而使用webpack打包时会自动在依赖关系中引入module.js。</p>
<span id="OSC_h3_5"></span>
<h3 id="h3_4">加载器</h3>
<p> webpack提供了一个非常强大的loader功能，这个功能可以用于管理各种依赖关系模块，在webpack中所有的文件都视作一个模块。</p>
<p> 首先npm导入webpack loader：</p>
<pre class="hljs sql"><code class="language-bash hljs">npm <span
        class="hljs-keyword">install</span> css-loader <span class="hljs-keyword">style</span>-loader</code></pre>
<p>添加一个用于测试的style.css文件：</p>
<pre class="hljs css"><code class="language-css hljs"><span class="hljs-selector-tag"><span
        class="hljs-selector-tag">h1</span></span>{
    <span class="hljs-attribute"><span class="hljs-attribute">color</span></span>:red;
}</code></pre>
<p> 在entry.js中添加引用：</p>
<pre class="hljs javascript"><code class="language-javascript hljs"><span class="hljs-comment"><span
        class="hljs-comment">/**
 * Created by chkui on 2016/11/16.
 */</span></span>
<span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span
            class="hljs-string">"!style!css!./style.css"</span></span>);<span class="hljs-comment"><span
            class="hljs-comment">//添加对css的引用</span></span>
<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.write(<span class="hljs-string"><span
            class="hljs-string">'&lt;h1&gt;hello webpack&lt;/h1&gt;'</span></span>);
<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.write(<span class="hljs-built_in"><span
            class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'./module.js'</span></span>));</code></pre>
<p> 使用命令行打包：</p>
<pre class="hljs elixir"><code class="language-bash hljs">webpack ./entry.js bundle.js --<span class="hljs-keyword">module</span>-bind <span
        class="hljs-string"><span class="hljs-string">'css=style!css'</span></span></code></pre>
<p>&nbsp;&nbsp;&nbsp;&nbsp;会发现css的样式生效了。可以将繁琐的“!style!css!./style.css”简写成"./style.css"。</p>
<span id="OSC_h3_6"></span>
<h3 id="h3_5">使用配置管理</h3>
<p> 细心的人会发现，我们每次使用命令行打包都带了大量的参数，这样不仅繁琐更不利于规模化使用。webpack同样可以使用标准化配置文件来替代命令行中的各种参数。</p>
<p> webpack的配置文件是nodejs的文件，通常命名为&nbsp;<code>webpack.config.js</code>。我们在工程中增加配置文件：</p>
<pre class="hljs typescript"><code class="language-javascript hljs"><span class="hljs-comment"><span
        class="hljs-comment">/**
 * Created by chkui on 2016/11/16.
 */</span></span>
<span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = {
    entry: <span class="hljs-string"><span class="hljs-string">'./entry.js'</span></span>,<span
            class="hljs-comment"><span class="hljs-comment">//定义要引入的js文件</span></span>
    output: {
        path: __dirname,
        filename: <span class="hljs-string"><span class="hljs-string">'bundle.js'</span></span> <span
            class="hljs-comment"><span class="hljs-comment">//定义要输出的js文件</span></span>
    },
    <span class="hljs-built_in"><span class="hljs-keyword">module</span></span>: {
        loaders: [<span class="hljs-comment"><span class="hljs-comment">//定义加载内容</span></span>
            {test: <span class="hljs-regexp"><span class="hljs-regexp">/\.css$/</span></span>, loader: <span
            class="hljs-string"><span class="hljs-string">'style!css'</span></span>}
        ]
    }
}</code></pre>
<p> 现在，我们在命令行中输入webpack就可以实现和前面一样的打包。</p>
<span id="OSC_h3_7"></span>
<h3 id="h3_6">&nbsp;&nbsp;&nbsp;&nbsp;丰富打包输出内容</h3>
<p> 可以使用：</p>
<pre class="hljs lua"><code class="hljs lua">webpack <span class="hljs-comment"><span class="hljs-comment">--progress --colors</span></span></code></pre>
<p> 命令来丰富打包输出的内容，更容易了解出现的问题。</p>
<span id="OSC_h3_8"></span>
<h3 id="h3_7">&nbsp; &nbsp; 监听更新模式</h3>
<p>
    在我们进行编码开发的时候，每次对文件的编辑我们都想立即看到编译效果，如果每次编辑都要去打包，会非常麻烦。webpack提供了一个监听模式（类似grunt的watch），用于监听每次对文件的修改，修改后会立即进行增量更新。启用监听模式：</p>
<pre class="hljs lua"><code class="hljs lua">webpack <span class="hljs-comment"><span class="hljs-comment">--progress --colors --watch</span></span></code></pre>
<p>
    监听模式使用的是内存增量更新。webpack会将所有需要打包的文件copy到内存，然后监控文件修改，如果文件发生了修改，会将修改的文件替换内存中的对应文件。因此开发完之后，切记进行一次手动打包才能生效。</p>
<span id="OSC_h3_9"></span>
<h3 id="h3_8">&nbsp; &nbsp; 开发环境模式</h3>
<p> webpack更强大的是，他整合了nodejs的express提供了一个静态服务器。（虽然没有官方正式，我觉得webstrom和微信本地开发环境都是整合的nodejs的express）</p>
<p> 使用了开发环境模式，我们所有的动态修改和操作都可以实时看到效果，并且解决了静态资源各种路径引用的问题。首先npm安装工具：</p>
<pre class="hljs sql"><code class="language-bash hljs">npm <span
        class="hljs-keyword">install</span> webpack-dev-<span class="hljs-keyword">server</span> -g</code></pre>
<p> 然后使用命令行工具启用开发环境：</p>
<pre class="hljs lua"><code class="language-bash hljs">webpack-dev-server <span
        class="hljs-comment">--progress --colors</span></code></pre>
<p> webpack的开发环境模式很强悍，比使用--watch更犀利的地方在于可以实现编辑即可见。浏览器立即同步刷新运行。开发环境模式可以延伸到生产环境实现代码同步级别的热部署。&nbsp;</p>
<span id="OSC_h4_10"></span>
<h4 id="h4_9">&nbsp; &nbsp; 开发环境扩展——webstorm的坑</h4>
<p>
    由于本人的前端页面使用webstorm开发，在使用过程中发现了一个webstorm的坑。webstorm有文件缓存的功能，在编辑完毕保存之后并不会实时的更新磁盘文件，这样的就导致webpack的开发环境无法同步更新文件。以下是解决方法：</p>
<p> 1.File-&gt;settings-&gt;System Settings</p>
<p> 2.找到弹出框的Use "safe write"，将其勾选解除。</p>
<figure><img alt="" height="507" src="https://static.oschina.net/uploads/space/2016/1116/230900_u1fD_2649413.png"
             width="1020"></figure>
<span id="OSC_h3_11"></span>
<h3 id="h3_10">输出调试信息</h3>
<p> webpack的配置较为复杂，一不小心就会出现错误。它提供了一个输出调试信息的参数：</p>
<pre class="hljs lua"><code class="language-bash hljs">$ webpack <span
        class="hljs-comment">--display-error-details</span></code></pre>
<p> 调试运行webpack命令出错的时候使用。Webpack 中涉及路径配置最好使用绝对路径，建议通过&nbsp;<code>path.resolve(__dirname,
    "app/folder")</code>&nbsp;或&nbsp;<code>path.join(__dirname, "app", "folder")</code>&nbsp;的方式来配置，以兼容 Windows 环境。
</p>
<span id="OSC_h3_12"></span>
<h3 id="h3_11">webpack插件</h3>
<p> 某些时候，webpack的常规功能无法满足我们的需求，我们可以为webpack开发插件，或者使用其他开发团队已经完成的插件。</p>
<p> 下面是一个插件的标准格式：</p>
<pre class="hljs javascript"><code class="language-javascript hljs"><span class="hljs-function"><span
        class="hljs-keyword"><span class="hljs-function"><span
        class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span
        class="hljs-title"><span class="hljs-function"><span class="hljs-title">MyPlugin</span></span></span><span
        class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span
        class="hljs-params">options</span></span></span><span class="hljs-function">) </span></span>{
  <span class="hljs-comment"><span class="hljs-comment">// Configure your plugin with options...</span></span>
}

MyPlugin.prototype.apply = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span
            class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span
            class="hljs-params"><span class="hljs-function"><span
            class="hljs-params">compiler</span></span></span><span class="hljs-function">) </span></span>{
  compiler.plugin(<span class="hljs-string"><span class="hljs-string">"compile"</span></span>, <span
            class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span
            class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span
            class="hljs-params">params</span></span></span><span class="hljs-function">) </span></span>{
    <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span
            class="hljs-string">"The compiler is starting to compile..."</span></span>);
  });

  compiler.plugin(<span class="hljs-string"><span class="hljs-string">"compilation"</span></span>, <span
            class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span
            class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span
            class="hljs-params">compilation</span></span></span><span class="hljs-function">) </span></span>{
    <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span
            class="hljs-string">"The compiler is starting a new compilation..."</span></span>);

    compilation.plugin(<span class="hljs-string"><span class="hljs-string">"optimize"</span></span>, <span
            class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span
            class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span
            class="hljs-params"></span>) </span></span>{
      <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span
            class="hljs-string">"The compilation is starting to optimize files..."</span></span>);
    });
  });

  compiler.plugin(<span class="hljs-string"><span class="hljs-string">"emit"</span></span>, <span class="hljs-function"><span
            class="hljs-keyword"><span class="hljs-function"><span
            class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span
            class="hljs-params"><span class="hljs-function"><span
            class="hljs-params">compilation, callback</span></span></span><span
            class="hljs-function">) </span></span>{
    <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span
            class="hljs-string">"The compilation is going to emit files..."</span></span>);
    callback();
  });
};

<span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = MyPlugin;</code></pre>
<p>需要实现什么功能，可以按照这个标准去开发自己的插件。</p>
<span id="OSC_h2_13"></span>
<h2 id="h2_12">React开发</h2>
<p> 使用webpack搭建好开发环境后，我们就可以开始着手开发react了。开始之前，我们还是要优先完成开发环境的配置和搭建。</p>
<p>
    react使用的语法是jsx，现在还新增了对es6的支持。为了可以高效开发，我们需要使用webpack的loader功能，将jsx或es6使用语法糖转义成浏览器可以识别的标准JavaScript语法。</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 下面将继续在前文webpack的基础上继续说明如何开发react。</p>
<span id="OSC_h3_14"></span>
<h3 id="h3_13">安装必要的依赖工具</h3>
<p> react的基础工具包：</p>
<pre class="hljs sql"><code class="language-bash hljs">$ npm <span class="hljs-keyword">install</span> react <span
        class="hljs-comment">--save-dev</span></code></pre>
<p> react的dom组件：</p>
<pre class="hljs sql"><code class="language-bash hljs">$ npm <span
        class="hljs-keyword">install</span> react react-dom <span
        class="hljs-comment">--save-dev</span></code></pre>
<p> 在前面介绍webpack的时候已经介绍了加载器的概念，这里需要额外安装babel用于对react的jsx风格的编码进行解析，babel除了jsx外还可以解析es6等。安装babel：</p>
<pre class="hljs elixir"><code class="language-bash hljs"><span class="hljs-variable">$ </span>npm install babel-loader</code></pre>
<p> 安装babel-loader之后\node_modules目录中会额外多安装一个babel-core，这是babel的核心包。</p>
<p> 有了babel，我们还需要安装编码转换规则，用于解析jsx、es6等等。</p>
<pre class="hljs sql"><code class="language-bash hljs">$ npm <span class="hljs-keyword">install</span> babel-preset-es2015 babel-preset-react <span
        class="hljs-comment">--save-dev</span></code></pre>
<p> 除了babel提供的es6和jsx，webpack还可以使用各种loader来转换编码，比如coffeescript等。想要什么就去google找吧。</p>
<span id="OSC_h3_15"></span>
<h3 id="h3_14">完善本地开发环境命令</h3>
<p> 前面的案例使用 webpack-dev-server
    来热部署本地开发环境提升开发效率。但是每次都靠长长的命令行启动和停止太过于繁琐。我们可以利用npm的package.json配置脚本运行来统一管理脚本命令：</p>
<pre class="hljs actionscript"><code class="language-javascript hljs">{
  <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span
            class="hljs-string">"demo2-react"</span></span>,
  <span class="hljs-string"><span class="hljs-string">"version"</span></span>: <span class="hljs-string"><span
            class="hljs-string">"1.0.0"</span></span>,
  <span class="hljs-string"><span class="hljs-string">"description"</span></span>: <span class="hljs-string"><span
            class="hljs-string">"react demo"</span></span>,
  <span class="hljs-string"><span class="hljs-string">"main"</span></span>: <span class="hljs-string"><span
            class="hljs-string">"index.js"</span></span>,
  <span class="hljs-string"><span class="hljs-string">"scripts"</span></span>:{
    <span class="hljs-string"><span class="hljs-string">"dev"</span></span>: <span class="hljs-string"><span
            class="hljs-string">"webpack-dev-server --progress --colors --inline"</span></span> <span
            class="hljs-comment"><span class="hljs-comment">//配置运行命令</span></span>
  },
  <span class="hljs-comment"><span class="hljs-comment">//more</span></span>
}</code></pre>
<p> 添加了scripts后，我们今后只需要运行</p>
<pre class="hljs elixir"><code class="language-bash hljs"><span
        class="hljs-variable">$ </span>npm run dev</code></pre>
<p> 即可使用配置好的命令行参数启动本地开发环境服务器。</p>
<span id="OSC_h3_16"></span>
<h3 id="h3_15">终于可以开始码农的核心工作了</h3>
<p> （demo代码存放在：<a href="https://github.com/chkui/react-demo" rel="nofollow">https://github.com/chkui/react-demo</a>。下载后用
    npm install 下载npm依赖即可使用）</p>
<p> 前面准备了这么久，就是为了随后我们可以快乐的编码。首先我们按照下面这个结构创建工程结构：</p>
<pre class="hljs haml"><code class="hljs haml"><span class="hljs-comment"><span
        class="hljs-comment">/root</span></span>
-<span class="ruby"><span class="ruby">-</span><span class="hljs-regexp"><span class="ruby"><span class="hljs-regexp">/dev
</span></span></span></span>-<span class="ruby"><span class="hljs-regexp"><span class="ruby"><span class="hljs-regexp">---/js</span></span></span><span
            class="ruby">
</span></span>-<span class="ruby"><span class="ruby">-----</span><span class="hljs-regexp"><span class="ruby"><span
            class="hljs-regexp">/index
</span></span></span></span>-<span class="ruby"><span class="hljs-regexp"><span class="ruby"><span class="hljs-regexp">-------/comps</span></span></span><span
            class="ruby">
</span></span>-<span class="ruby"><span class="ruby">---------component1.jsx
</span></span>-<span class="ruby"><span class="ruby">---------main.jsx
</span></span>-<span class="ruby"><span class="ruby">-------index.js
</span></span>-<span class="ruby"><span class="ruby">---</span><span class="hljs-regexp"><span class="ruby"><span
            class="hljs-regexp">/style
</span></span></span></span>-<span class="ruby"><span class="hljs-regexp"><span class="ruby"><span class="hljs-regexp">-----/index</span></span></span><span
            class="ruby">
</span></span>-<span class="ruby"><span class="ruby">-------index.css
</span></span>-<span class="ruby"><span class="ruby">---index.html</span></span></code></pre>
<p> 然后根据工程的结构修改我们的webpack.config.js：</p>
<pre class="hljs typescript"><code class="language-javascript hljs"><span class="hljs-comment"><span
        class="hljs-comment">/**
 * Created by Administrator on 2016/11/17.
 */</span></span>
<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> path = <span class="hljs-built_in"><span
            class="hljs-built_in">require</span></span>(<span class="hljs-string"><span
            class="hljs-string">'path'</span></span>);
<span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = {
    entry: [<span class="hljs-string"><span class="hljs-string">'./dev/js/index/comps/main.jsx'</span></span>],<span
            class="hljs-comment"><span class="hljs-comment">//定义要引入的js文件</span></span>
    output: {
        path: __dirname,
        filename: <span class="hljs-string"><span class="hljs-string">'./dev/js/index/index.js'</span></span> <span
            class="hljs-comment"><span class="hljs-comment">//定义要输出的js文件</span></span>
    },
    <span class="hljs-built_in"><span class="hljs-keyword">module</span></span>: {
        loaders: [{
            test: <span class="hljs-regexp"><span class="hljs-regexp">/\.js[x]?$/</span></span>,
            exclude: <span class="hljs-regexp"><span class="hljs-regexp">/(node_modules|bower_components)/</span></span>,
            loader: <span class="hljs-string"><span class="hljs-string">'babel-loader'</span></span>,
            query: {
                presets: [<span class="hljs-string"><span class="hljs-string">'es2015'</span></span>,<span
            class="hljs-string"><span class="hljs-string">'react'</span></span>]
            }
        }, {
            test: <span class="hljs-regexp"><span class="hljs-regexp">/\.css$/</span></span>,
            loader: <span class="hljs-string"><span class="hljs-string">'style!css'</span></span>
        }, {
            test: <span class="hljs-regexp"><span class="hljs-regexp">/\.(png|jpg)$/</span></span>,
            loader: <span class="hljs-string"><span class="hljs-string">'url?limit=25000'</span></span> <span
            class="hljs-comment"><span class="hljs-comment">//只解析小于25000字节的图片</span></span>
        }]
    }
};</code></pre>
<p> 和前面介绍webpack的例子相比，这里的配置文件新增了了一个babel-loader的配置。</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;test后的正则表达式表示对所有的js或者jsx文件进行解析；</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; exclude表示不解析npm安装目录下和bower安装目录下的文件；</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; loader表示使用的解析工具；</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;
    query表示扩展参数，这里的'es2015'和'react'表示启用babel-preset-es2015和bable-preset-react解析规则。这里需要注意的是解析的优先级的倒序的，即会先解析‘react’。</p>
<p> 然后我们添加编码内容（所有的例子都分别实现了jsx规范和es2015规范）：</p>
<p> index.html：</p>
<pre class="hljs xml"><code class="language-html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span
        class="hljs-name">html</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span
        class="hljs-tag"><span class="hljs-attr">lang</span></span></span><span class="hljs-tag">=</span><span
        class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"en"</span></span></span><span
        class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span
        class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span>
    <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span
            class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span
            class="hljs-tag"><span class="hljs-attr">charset</span></span></span><span class="hljs-tag">=</span><span
            class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"UTF-8"</span></span></span><span
            class="hljs-tag">&gt;</span></span>
    <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span
            class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>Title<span
            class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span
            class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span
        class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span
        class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span>
    <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span
            class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span
            class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span
            class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"comp"</span></span></span><span
            class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span
            class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span
            class="hljs-tag">&gt;</span></span>
    <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span
            class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span
            class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span
            class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/dev/js/index/index.js"</span></span></span><span
            class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span
            class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span
            class="hljs-tag"><span class="hljs-name">script</span></span></span><span
            class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span
        class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span
        class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code></pre>
<p> main.jsx：</p>
<pre class="hljs javascript"><code class="language-javascript hljs"><span class="hljs-comment"><span
        class="hljs-comment">/**
 * Created by chkui on 2016/11/17.
 */</span></span>

<span class="hljs-comment"><span class="hljs-comment">//jsx</span></span>
<span class="hljs-comment"><span class="hljs-comment">/*
var React = require('react');
var ReactDOM = require('react-dom');
var Comp1 = require('./component1.jsx');
require('../../../style/index/index.css');

ReactDOM.render(
    &lt;div className="main"&gt;
        react jsx demo:
        &lt;Comp1 /&gt;
    &lt;/div&gt;,
    document.getElementById('comp')
);
*/</span></span>

<span class="hljs-comment"><span class="hljs-comment">//es2015</span></span>
<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span
            class="hljs-keyword">from</span></span> <span class="hljs-string"><span
            class="hljs-string">'react'</span></span>;
<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ReactDOM <span class="hljs-keyword"><span
            class="hljs-keyword">from</span></span> <span class="hljs-string"><span
            class="hljs-string">'react-dom'</span></span>;
<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Comp1 <span class="hljs-keyword"><span
            class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./component1.jsx'</span></span> <span
            class="hljs-comment"><span class="hljs-comment">/*切记，大写是变量小写是标签*/</span></span>
<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> style <span class="hljs-keyword"><span
            class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../../../style/index/index.css'</span></span>

ReactDOM.render(
    <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span
            class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span
            class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span
            class="hljs-tag"><span class="hljs-attr">className</span></span></span></span><span class="xml"><span
            class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span
            class="hljs-string">"main"</span></span></span></span><span class="xml"><span
            class="hljs-tag">&gt;</span></span></span><span class="xml">
        react es2015 demo:
        </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span
            class="hljs-name"><span class="xml"><span class="hljs-tag"><span
            class="hljs-name">Comp1</span></span></span></span><span class="xml"><span
            class="hljs-tag"> /&gt;</span></span></span><span class="xml">
    </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span
            class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span
            class="xml"><span class="hljs-tag">&gt;</span></span></span></span>
    ,
    <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span
            class="hljs-string"><span class="hljs-string">'comp'</span></span>)
);
</code></pre>
<p> component1.jsx：</p>
<pre class="hljs scala"><code class="language-javascript hljs"><span class="hljs-comment"><span
        class="hljs-comment">/**
 * Created by Administrator on 2016/11/17.
 */</span></span>

<span class="hljs-comment"><span class="hljs-comment">//jsx</span></span>
<span class="hljs-comment"><span class="hljs-comment">/*
var React = require('react');
var comp1 = React.createClass({
    render: function () {
        return (
          &lt;div className = "index"&gt;
            hello react!
          &lt;/div&gt;
        );
    }
});
module.exports = comp1;
*/</span></span>
<span class="hljs-comment"><span class="hljs-comment">//es6</span></span>
<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-type">React</span> <span
            class="hljs-keyword">from</span> <span class="hljs-string"><span
            class="hljs-string">"react"</span></span>
<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span
        class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span
        class="hljs-class"><span class="hljs-title">Comp1</span></span></span><span class="hljs-class"> </span><span
        class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span
        class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span
        class="hljs-title">React</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span
        class="hljs-class"><span class="hljs-title">Component</span></span></span></span>{
    <span class="hljs-comment"><span class="hljs-comment">//构造函数</span></span>
    <span class="hljs-keyword">constructor</span>(...args){
        <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(...args);
    }
    <span class="hljs-comment"><span class="hljs-comment">//覆盖父类的渲染方法</span></span>
    render() {
        <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (
            <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span> = <span
                    class="hljs-string"><span class="hljs-string">"index"</span></span>&gt;</span>
                hello react!
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
        );
    }
}
<span class="hljs-keyword">export</span> <span class="hljs-keyword"><span
            class="hljs-keyword">default</span></span> <span class="hljs-type">Comp1</span>;
</code></pre>
<p> 编码完毕之后，我们使用我们设定好的脚本运行我们的本地开发环境：</p>
<pre class="hljs elixir"><code class="language-bash hljs"><span
        class="hljs-variable">$ </span>npm run dev</code></pre>
<p> 启动时，所有的文本都会被读取到内存中，我们可以根据输出来聊天到底添加了哪些依赖的文件。启动完成后，浏览器上输入&nbsp;http://localhost:8080/dev/index.html 或&nbsp;http://localhost:8080/webpack-dev-server/dev/index.html
    即可看到我们用react开发的页面。此时修改js或css文件，编辑效果都会立刻呈现在浏览器上。</p>
<span id="OSC_h2_17"></span>
<h2 id="h2_16">React浏览器调试工具</h2>
<p> Facebook提供了基于chrome的页面调试工具，可以看到所有react组件及其效果。</p>
<p> 工具安装：</p>
<ol>
    <li>首先最重要的是——翻墙-_-。不翻墙chrome的网上商店就别想了。</li>
    <li>然后在chrome网店搜索“React Developer Tool”。</li>
    <li>找到后添加到chrome。</li>
</ol>
<p>添加完成后可以发现在chrome中增加了react的图标。</p>
<figure><img alt="" height="282" src="https://static.oschina.net/uploads/space/2016/1117/160442_0rD1_2649413.png"
             width="638"></figure>
<p>然后在demo页面按F12打开开发人员工具，会发现多了一个React栏目。选择这个栏目后，会显示出React组件的效果。</p>
<figure><img alt="" height="198" src="https://static.oschina.net/uploads/space/2016/1117/160820_fsVn_2649413.png"
             width="693"></figure>
</div>